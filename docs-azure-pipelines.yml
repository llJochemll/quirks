trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

container: dlang2/dmd-ubuntu:latest

steps:
- bash: |
    su root
    apt-get install hub
    apt-get install git
  displayName: 'Install hub'

- script: |
    git checkout -b docs
  displayName: 'Switch to docs branch'

- script: |
    dub upgrade
    dub build -b ddox
  displayName: 'Build documentation'

- script: |
    git commit -m "[skip ci] Update docs"
    git push
    hub pull-request --base OWNER:master -m "Update docs"
  displayName: 'Create pull request'